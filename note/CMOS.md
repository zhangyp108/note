# 1. 引论



## MOS晶体管

​	硅是一种半导体，大多数集成电路的基础原材料。

​    纯净的硅由三维的原子晶格(lattice)组成。硅是IV族元素因此它与其相邻的四个原子形成共价键但实际上它形成的是一个立方晶体。由于它的所有价电子都参与了化学键，因此纯净硅是一种不良导体。但它的导电性可以通过在硅晶格中引人称为掺杂剂(dopant)的少量杂质来提高。

二极管：p 型与n型硅之间形成的结称为二极管(diode)，当称为阳极(anode)的p型半导体上的电压高于n型的阴极(cathode)时二极管正向偏置(forward biased)于是就会有电流流过。当阳极电压低于或等于阴极电压时，二极管反向偏置(reverse biased)，此时几乎没有什么电流。

金属-氧化物-半导体(MOS)结构是通过把几层到点和绝缘材料叠在一起形成类似三明治的结构而构成的

CMOS工艺提供两种类型的晶体管，它们也称为器件(device)：n型晶体管(nMOS)和p型晶体管(pMOS)

[![image-20230421213617184](https://camo.githubusercontent.com/5c4078b0f9c0b80f6f1deceed30ba5802f244a29dbc2d0575be7da6794d2d61f/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343231323133363839312e706e67)](https://camo.githubusercontent.com/5c4078b0f9c0b80f6f1deceed30ba5802f244a29dbc2d0575be7da6794d2d61f/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343231323133363839312e706e67)



​	晶体管的工作是由电场控制的，所以这些器件又称为金属氧化物半导体场效应晶体管(MOSFET)每个晶体管由一层导电栅(gate)、一层二氧化硅绝缘层以及一层硅基底（也称衬底、体、体硅）堆叠构成，这一叠层结构杯称为金属-氧化物-半导体或MOS（早起栅由金属形成，现在用多晶硅）。

​	在同时有这两种类型晶体管的CMOS工艺中，衬底可以使n型的，也可以是p型的，但类型与衬底上晶体管不同的另一种晶体管必须构造在专门的阱(well)中，阱中加入了掺杂院子以形成相反类型的衬底

​	源和漏是完全一样的，可以互换。栅是一个控制输入：它影响电流在源和漏之间的流动

nMOS管：其衬底一般接地，而源和漏雨衬底之间的p-n结都是反向偏置的。如果栅也接地，那么不会有电流流过反偏结，于是称此时晶体管关断。如果提高栅电压，会建立一个电场将自由电子吸引到Si-SiO~~2~~的界面下，栅压足够高时电子数目将超过空穴，栅下方称为”沟道“(channel)的一层区域将反型称为n型半导体，源和漏之间形成通路，此时晶体管导通

pMOS管：与nmos相反，其衬底保持在正电压。pMOS管的行为与nMOS管相反，其符号在栅极上有个小圆圈，就如逻辑门中反相器符号图上的小圆圈

[![image-20230421220529532](https://camo.githubusercontent.com/6bf7a00f823d0aa83be3b18c7c83dfc4806ee5469a2dc4ab813ae3c1e6c03763/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343231323230353630372e706e67)](https://camo.githubusercontent.com/6bf7a00f823d0aa83be3b18c7c83dfc4806ee5469a2dc4ab813ae3c1e6c03763/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343231323230353630372e706e67)

图1.10中g、s和d分别表示栅、源和漏



## 1.4 CMOS逻辑



### 1.4.1 反相器

它由一个 nMOS 管和一个 pMOS 管构成。电路图顶部的短横杠表示 Vop，而底部的小三角形表示 GND。当输人 A为0时nMOS管关断而pMOS管导通，输出Y被上拉至1，因为它被连至Vo而不是 GND。相反，当A为1时，nMOS 导通，pMOS 关断，Y被下拉至0。

[![image-20230421220707493](https://camo.githubusercontent.com/6642e7155b9a9d4969f325f46e8aa4daf66c227e3d8db9356ca2664dd4a1a74e/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343231323230373537322e706e67)](https://camo.githubusercontent.com/6642e7155b9a9d4969f325f46e8aa4daf66c227e3d8db9356ca2664dd4a1a74e/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343231323230373537322e706e67)



[![image-20230421221117543](https://camo.githubusercontent.com/8dfe672715b7f3db59e1cb74e7eb3ceec221c959a5b5676d2da00d849ac0112f/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343231323231313631352e706e67)](https://camo.githubusercontent.com/8dfe672715b7f3db59e1cb74e7eb3ceec221c959a5b5676d2da00d849ac0112f/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343231323231313631352e706e67)

### 

### 1.4.2 与非(NAND)门

它由两个在Y和GND之间串联在一起的nMOS 管和两个在Y和V之间并联的 pMOS 管构成。如输人A和B中有任何一个为0，那么至少有一个 nMOS 管关断，这将断开从Y至CND 的通路，但此时至少有1个pMOS 管导通，从而建立起Y至Vdd的通路，因此输出Y将为1。如果两个输人均为1，那么两个nMOS 管都导通而两个 pMS 管都关断，因此输出Y将为0。

[![image-20230421221305213](https://camo.githubusercontent.com/4fab860e79195bed6261fca4ac26e68a9927a1d6a226cb11948222ed62ab44c9/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343231323231333238392e706e67)](https://camo.githubusercontent.com/4fab860e79195bed6261fca4ac26e68a9927a1d6a226cb11948222ed62ab44c9/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343231323231333238392e706e67)

[![image-20230421221834043](https://camo.githubusercontent.com/47b76609b3d66221f4e09b1609d4141b70ec8370a38ae1d6d31a1e16542f1e6d/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343231323231383134302e706e67)](https://camo.githubusercontent.com/47b76609b3d66221f4e09b1609d4141b70ec8370a38ae1d6d31a1e16542f1e6d/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343231323231383134302e706e67)



### 1.4.3 CMOS逻辑门

​	反相器和与非门是静态CMOS逻辑门(static CMOS logic gate)也称互补CMOS门(complementary CMOS gate)的两个例子

​	静态CMOS门中的这两个网络被设计成对于任何一种输入图案，其中必有一个网络导通，而另一个关断。

[![image-20230421222847334](https://camo.githubusercontent.com/05cbd32326912188ef54ce995ed988846729709a628bb4086eaf727ce4279ad2/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343231323232383431322e706e67)](https://camo.githubusercontent.com/05cbd32326912188ef54ce995ed988846729709a628bb4086eaf727ce4279ad2/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343231323232383431322e706e67)



[![image-20230421224126489](https://camo.githubusercontent.com/52e2cb337ebe06d4bcfc798c7bcf47cbfc3cc2cb6cda8c11eec73be7b32cce69/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343231323234313536312e706e67)](https://camo.githubusercontent.com/52e2cb337ebe06d4bcfc798c7bcf47cbfc3cc2cb6cda8c11eec73be7b32cce69/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343231323234313536312e706e67)

- Z：当上拉和下拉都关断时会形成高阻(high impedance)，即浮空(floating)的输出状态Z。这在多路开关、存储单元及三态总线驱动器中很有意义
- X：当上拉而和下拉同事导通时就形成竞争(contention)电平，急用叉号(crowbar)表示的电平X。此时这连个网络之间的竞争将产生一个不确定的输出电平并引起静态功耗，这是我们不希望出现的情况

​	反相器中的上拉和下拉网络每个都只含一个晶体管，与非门采用一个晶体管串联的下拉网络和一个晶体管斌两的上拉网络

​	两个或多个晶体管的串联组合只有当所有串联的晶体管都导通时才导通，两个或多个晶体管的并联组合只要其中任何一个并联的晶体管导通就能导通。下面是一对nMOS管和pMOS管串并联时的情形，利用这些结构的组合可以构造出许多种CMOS组合门

[![image-20230421223907720](https://camo.githubusercontent.com/93b864ddfdab497f5d34d85f13cbf8d2a8f7f15812fc223c81e8180d1f9dbc09/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343231323233393831322e706e67)](https://camo.githubusercontent.com/93b864ddfdab497f5d34d85f13cbf8d2a8f7f15812fc223c81e8180d1f9dbc09/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343231323233393831322e706e67)



### 1.4.4 或非(NOR)门

​	对于三输入或非门，当任何一个输入为高时，输出通过并联的nMOS管下拉至低电平。当所有输入为低时，输出通过串联的pMOS管上拉至高电平

[![image-20230421224644605](https://camo.githubusercontent.com/e761bd6976badd0628d90b865d4889fe8991ae6840ddb6c00e09d0f6866fcf84/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343231323234363639312e706e67)](https://camo.githubusercontent.com/e761bd6976badd0628d90b865d4889fe8991ae6840ddb6c00e09d0f6866fcf84/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343231323234363639312e706e67)





### 1.4.5 复合门(compound gate)

[![image-20230421225543323](https://camo.githubusercontent.com/3fc5e2a7bf8d0f4004d05faeca47afed1a7133a4fab412a3016b0f78d05ba0e9/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343231323235353431372e706e67)](https://camo.githubusercontent.com/3fc5e2a7bf8d0f4004d05faeca47afed1a7133a4fab412a3016b0f78d05ba0e9/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343231323235353431372e706e67)

   由单级逻辑完成较复杂逻辑功能的复合门是通过串联和并联开关结构的组合来实现的。例如，可以推导出实现功能Y = (A·B) +(C·D)的电路

​	图1.18中的a、b相对容易理解，“与”的表达式可以通过串联实现。接下来将“或”拆分为两部分，一个为a中两组一组导通则下拉，因此a中两组并联且置于下方，也就是nMOS下拉网络

​	 对于pMOS上拉网络，我们必须计算与nMOS网络互补的表达式，它所采用的开关管在极性相反的输入时导通。根据德摩根定理，这相当于将一个网络中的“与”（“或”）操作与另一个网络中的“或”（“与”）操作互换。因此与下拉网络中串联nMOS管相对应的上拉网络中的pMOS管必须并联，而与下拉网络中并联nMOS管相对应的上拉网络中的pMOS管必须串联。

​	







[![image-20230421235645374](https://camo.githubusercontent.com/d4e8760b82cfadfcd0a4b59d0c7085f54f9cd594971e864a172787b615e4702d/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343231323335363434352e706e67)](https://camo.githubusercontent.com/d4e8760b82cfadfcd0a4b59d0c7085f54f9cd594971e864a172787b615e4702d/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343231323335363434352e706e67)

​     或-与-非-3-1（即OAI31）门。当D为1且ABC中任何一个为1时，nMOS下拉网络将时输出下拉为低电平，所以D和A、B及C的并联组合串联在一起。由于pMOS上拉网络是nMOS下拉网络的“互补导通”，所以在pMOS上拉网络中D必须和A、B及C的串联组合并联



### 1.4.6 传输管(Pass Transistor)和传输门(Transmission Gate)

​	一个信号的强度(strength)是以它与理想电压源的接近程度来度量的。一般来说，信号越强它所能提供或吸收的电流就越多。

​	电源电压V~~DD~~和GND各为最强的1和0信号源，又称轨线(rail)电压

​    nMOS管在传送0时是一个近乎理想的开关，因此说能传送“强0”；而传送1时不理想，得到的高电压比V~~DD~~要低些。pMOS管则相反。输入驱动下拉网络中nMOS只需传送0，而互补上拉网络中pMOS只需传送1，输出总是被强驱动，因而输出电平永远不会变弱，这样的门被称为“全复原”(full restored)逻辑门，能大大简化电路设计

[![image-20230422151015984](https://camo.githubusercontent.com/5c7d4afa5198c85beb1385888a42a12c884a5c1505eb875ccda652b85f46a4b0/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343232313531303036352e706e67)](https://camo.githubusercontent.com/5c7d4afa5198c85beb1385888a42a12c884a5c1505eb875ccda652b85f46a4b0/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343232313531303036352e706e67)

​	

[![image-20230422151810719](https://camo.githubusercontent.com/1b007fb6b5b14243d0744fc44bdb0c7ac14e04db6928d7535efc019b99dfbf80/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343232313531383832322e706e67)](https://camo.githubusercontent.com/1b007fb6b5b14243d0744fc44bdb0c7ac14e04db6928d7535efc019b99dfbf80/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343232313531383832322e706e67)

- 传输管：nMOS或pMOS单独作用作为一个非理想开关
- 传输门/传送门：将nMOS与pMOS并联、

​	在图1.21(c)中，无论0还是1都能被这个开关以一种可以接受的方式传送出去

​	静态CMOS门总能正确工作而与晶体管的实际尺寸无关，且对于任何输入组合，“1”和“0”之间不会有通过晶体管使它们直接导通的路径，这也是CMOS中静态功耗很低的主要原因

​	不能直接将反相器的上下拉管互换来构成非反相门，这样会产生减弱的输出

[![image-20230422153408295](https://camo.githubusercontent.com/be02566357fc90f77c9a764417c7804ad4901b1a39664d946c744d6a65397d47/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343232313533343430362e706e67)](https://camo.githubusercontent.com/be02566357fc90f77c9a764417c7804ad4901b1a39664d946c744d6a65397d47/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343232313533343430362e706e67)

​	复合门也可以也可以用两个与门、一个或门和一个反相器构成，而与门和或门又可以用与非/或非门及反相器构成，但这里总共需要20个晶体管

[![image-20230422153637483](https://camo.githubusercontent.com/b396c2e063f10509786373882c9ad0ad43d0830e0ab47869cbd2113018ce209e/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343232313533363535392e706e67)](https://camo.githubusercontent.com/b396c2e063f10509786373882c9ad0ad43d0830e0ab47869cbd2113018ce209e/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343232313533363535392e706e67)



### 1.4.7 三态门

​     当使能输入 EN为1时输出Y等于输人A，此时它的作用就像一个普通的缓冲器。当使能输入为0时，Y变为浮空(即等于“Z”值)这两种情形总结在表1.5中。

[![image-20230422153821179](https://camo.githubusercontent.com/8642e2a20b7a0c2b92c268395896bd28e11113d63b3aaf8d477f280628a8880f/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343232313533383235302e706e67)](https://camo.githubusercontent.com/8642e2a20b7a0c2b92c268395896bd28e11113d63b3aaf8d477f280628a8880f/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343232313533383235302e706e67)

​	

[![image-20230422154228860](https://camo.githubusercontent.com/2aeffa2ee1b5dee78cf5f237a36e6665b04d8d9f4bc9ac07fe1d93448a26f0eb/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343232313534323932392e706e67)](https://camo.githubusercontent.com/2aeffa2ee1b5dee78cf5f237a36e6665b04d8d9f4bc9ac07fe1d93448a26f0eb/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343232313534323932392e706e67)

   当EN为0时两个使能晶体管关断，使输出端浮空。当EN为1时(见图1.27(c))两个使能品体管导通，此时从原理上讲可以把它们从电路中删除而成为一个简单的反相器。

反相使能信号可以在单元内部产生，也可以从外部直接连线到这个单元。在一个普通反相器之后接个三态反相器就可以构成一个三态缓冲器。



### 1.4.8 多路开关(Multiplexer)

​       多路开关是 CMOS存储单元和数据处理结构中的关键部件。一个多路开关根据选择信号从它的几个输人中选择出其中一个作为输出。

逻辑函数：Y = S（反） ·DO + S ·DI

[![image-20230422172108206](https://camo.githubusercontent.com/8705bd168c165646c22f7a65765681b607d0688d81b8d5766b5172e627788e3c/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343232323034343531372e706e67)](https://camo.githubusercontent.com/8705bd168c165646c22f7a65765681b607d0688d81b8d5766b5172e627788e3c/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343232323034343531372e706e67)

可以将两个传输门连在一起构成一个简单的二输入多路开关，如图1.28(a)所示。在任何时刻，选择信号和它的反信号只“使能”两个传输门中的一个。反相选择信号 S 常常不画在符号中如图 1.28(b)所示。

[![image-20230422173234312](https://camo.githubusercontent.com/240deb91c2b634872463ab5c9308ca24e03ea330b3f3e9354ad5511c9793705f/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343232323034343532342e706e67)](https://camo.githubusercontent.com/240deb91c2b634872463ab5c9308ca24e03ea330b3f3e9354ad5511c9793705f/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343232323034343532342e706e67)



​       传输门构成的是一个非复原的多路开关。但我们有几种方式可以用逻辑门构成复原的反相多路开关。一种方式是将图 1.18(e)中的复合门连成如图1.29(a)那样;另一种方式是将两个二态反相器连接起来，如图 1.29(b)所示。

三态反相器的方式稍微简单一些并且速度也较快些，因为它需要的内部连线较少。同样，如果反相选择信号是在单元内部产生，那么可以把它从符号图中略去

反相和非反相多路开关都简称为多路开关或MUX。

### 1.4.9 时序电路(Sequential Circuit)

​	组合电路(combinational circuit)它们的输出仅取决于当前的输人。而时序电路具有记忆:它们的输出同时取决于当前和之前的输人。

​	如锁存器(latch)、触发器(flip-flop)这样的时序电路会接受一个时钟输入CLK和一个数据输入D，并产生一个输出Q。

- 一个D锁存器在CLK=1时透明(transparent)，即Q跟随D而改变;它在CLK=0时不透明(opaque)，即不管D如何变化, 仍保持它原来的值。
- 一个沿触发的触发器(edge-triggered fip-flop)只在CLK的上升沿时将D复制到Q，而在其他时间均保持它原来的值不变。



#### 1.4.9.1 锁存器(Latch)

[![image-20230423151013358](https://camo.githubusercontent.com/bc7b4a1599d4dbd6b2d0b6f5adf123ad3128f8f96f413733f040510507af53bb/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233313531303531352e706e67)](https://camo.githubusercontent.com/bc7b4a1599d4dbd6b2d0b6f5adf123ad3128f8f96f413733f040510507af53bb/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233313531303531352e706e67)

​	由于两个反相器可复原电平，因此多路开关可以用一对传输门构成，如图1.31(b)所示。这一锁存器也同时产生一个反相的输出0。当CLK=1 时锁存器透明，因而D通过它到达Q(见图1.31(c))。当CLK下降至0时，锁存器将变为不透明。

​	D锁存器也称为电平灵敏锁存器(Level-sensitive latch)，这是因为它的输出状态取决于时钟信号的电平

#### 1.4.9.2 触发器(Flip-Flop)

​	当将一个负电平灵敏和一个正电平灵敏连在一起时，就能构成边沿触发的触发器。第一级锁存器称为主锁存器(master)，而第二级称为从锁存器(slave)

[![image-20230423155016911](https://camo.githubusercontent.com/deced5f40b033bc37d1c7b76934874bc7d33b5a0c43217cf3d84eaa4a4fd89cb/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233313535303938352e706e67)](https://camo.githubusercontent.com/deced5f40b033bc37d1c7b76934874bc7d33b5a0c43217cf3d84eaa4a4fd89cb/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233313535303938352e706e67)

​	当CLK 为低时，负电平灵敏主锁存器的输出(QM)跟随输入D而变化，此时正电平灵敏的从锁存器保持它原来的值(见图 (c))。当时钟从0  跳变到1时，主锁存器变为不透明并保持在时钟跳变时的D值，而从锁存器变为透明，将主锁存器所保存的值(QM)传送至从锁存器的输出(Q)。由于此时主锁存器已与输人D断开(见图(d))，因而输人D被阻止而不会影响输出。当时钟从1跳变至0时，从锁存器保持它的值而主锁存器开始再次采样输入数据。

[![image-20230423155035550](https://camo.githubusercontent.com/6ef82826b5ab9adb8a68e9da3a9f16d7978b477a13f9d58a1bb9a4e7e004c74d/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233313535303631392e706e67)](https://camo.githubusercontent.com/6ef82826b5ab9adb8a68e9da3a9f16d7978b477a13f9d58a1bb9a4e7e004c74d/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233313535303631392e706e67)

​	一个好的设计会如(e)那样增加反相器来缓冲输入和输出，使它保持我们称之为“模块化”(modularity)的特性

​	这一触发器在时钟的上升沿时将 D复制到 Q，因此这一器件称为正沿触发的触发器(positive-edge  triggered flip-lop)，也称为D触发器(D ip-flop)D  寄存器(Dregister)或主从触发器(master-slave flip-flop)

​	当使它的两个锁存器的极性都相反时就可以构成一个负沿触发的触发器

​	共享公共时钟输入的多个 D触发器的集合称为寄存器(register)。寄存器常常画成具有多位 D和Q总线的触发器。

​	如果系统的时钟偏斜(clock skew)太大，即由于时钟到达时间的不同使一个触发器触发得早些而另一个触发器触发得晚些，那么触发器就有可能发生保持时间(hold-time)失效。

[![image-20230423161524045](https://camo.githubusercontent.com/0d82a48b3f2975a29bfe3549c5806e714140db30ac24aa85d84766feeabb4e42/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233313631353131382e706e67)](https://camo.githubusercontent.com/0d82a48b3f2975a29bfe3549c5806e714140db30ac24aa85d84766feeabb4e42/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233313631353131382e706e67)





## 1.5 CMOS的制造和版图

事实上设计者必须理解电路的物理实现，因为它对电路性能、功耗和成本都有极其重要的影响。晶体管制造在很薄的硅圆片(silicon wafer)上，片用来作为机械支撑又用来作为电气上的公共节点，即所谓的衬底(substrate)。

两个角度去考察晶体管的物理版图：

一个是顶视图，它是通过向下看圆片得到的。

另一个是横截面图，它是沿晶体管的中部切开圆片然后从侧面看它而得到的。

我们先看一个完整 CMOS 反相器的横截面图，然后看它的顶视图并定义一组用来制造该反相器不同部分的掩模。晶体管和导线的尺寸由掩模的尺寸确定并受制造工艺分辨率的限制。这一分辨率的不断提高推动了半导体工业的迅速发展。

### 

### 1.5.1 反相器的横截面图

[![image-20230423162025597](https://camo.githubusercontent.com/8aafb61be643ff0bf198eb49b68ef387078924184506990adcdce09f36d337b6/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233313632303637362e706e67)](https://camo.githubusercontent.com/8aafb61be643ff0bf198eb49b68ef387078924184506990adcdce09f36d337b6/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233313632303637362e706e67)

​	nMOS 晶体管包含重掺杂的n型源区和漏区以及在二氧化硅(SiO)薄层(也称为栅氧，即gate oxide)上的多晶硅栅。n+和p+扩散区是指重掺杂的n型和p型硅。

​	两个晶体管的多晶硅栅在某处连在一起(图中未画出)形成输入A。

​	两个晶体管的漏用金属线连在一起形成输出 Y。

​	除了明确刻蚀了接触孔的位置而外，在金属层与其他层之间还有一层称为场氧(feld oxide)的厚二氧化硅(SiO层用来防止金属与其他层之间发生短路。

​	金属与轻掺杂半导体之间的结形成了只能沿一个方向传送电流的肖特基二极管(Schotky  di-ode)。当半导体掺杂较重时，它与金属间形成良好的欧姆接触，因而对双向电流都呈现低阻。衬底必须连至低电位以避免p 型衬底和 nMOS  的n+源或漏之间的p-n 结发生正向偏置。同样，n阱必须连至高电位。通过增加重掺杂的衬底接触和阱接触(或称接头，即 tap)，可以将  GND(低电位)和 Vdd(高电位)分别连至村底和n阱。

### 

### 1.5.2 制造工艺

​	假定反相器由六层掩膜定义：n阱、多晶硅、n+扩散、p+扩散、接触和金属，实际掩膜组往往更复杂

[![image-20230423162049049](https://camo.githubusercontent.com/9fa4c9c4837a099bd73660654cd4e58efa6201b367a3ddda8d9bd66bf3771d43/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233313632303134312e706e67)](https://camo.githubusercontent.com/9fa4c9c4837a099bd73660654cd4e58efa6201b367a3ddda8d9bd66bf3771d43/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233313632303134312e706e67)

[![image-20230423162110242](https://camo.githubusercontent.com/a9493e42465dcc92d38c451d0889f3e53d8857816a7d25d8b5abf9daf92276e4/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233313632313331382e706e67)](https://camo.githubusercontent.com/a9493e42465dcc92d38c451d0889f3e53d8857816a7d25d8b5abf9daf92276e4/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233313632313331382e706e67)

制造过程从在一块p 型的裸圆片上制作 n阱开始。图1.36 为在形成n过中每一工艺步完成后的片横截面图。图1.36(a)为制作过程开始前的裸衬底。形成  阱需要把足够的V 族元素杂剂加人到硅村底中，使它在阱区由p型底变为n型村底为了定义形成 阱的区域，我们先在整个圆片上生长一层二氧化保护层，然后在需要形成阱的地方把它除去。接着加入 n 型掺杂剂。这些掺杂剂会受到二氧化硅的阻挡，但在没有二氧化硅的地方它们将进入衬底并形成阱。

[![image-20230423212300600](https://camo.githubusercontent.com/064a780be35ad75f6323d42ada7c0f333fb5bb980395458e23ba32f1223a7863/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233323132333735322e706e67)](https://camo.githubusercontent.com/064a780be35ad75f6323d42ada7c0f333fb5bb980395458e23ba32f1223a7863/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233323132333735322e706e67)



[![image-20230423215639228](https://camo.githubusercontent.com/f183b72ac942303c25544a952ee952247c0cc6e696e480f32c0b9971349ec102/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233323135363334332e706e67)](https://camo.githubusercontent.com/f183b72ac942303c25544a952ee952247c0cc6e696e480f32c0b9971349ec102/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233323135363334332e706e67)

​		多晶硅需要进行重掺杂，使它变成一种良好的导体

​		 n^+^区通常是用离子注人的方法形成的，但它们在历史上曾经用扩散的方法，因而仍常称它们为n扩散区(n-diffusion)。在nMOS管上的多晶硅栅阻挡了扩散，因此源和漏被栅下的沟道隔开。这一工艺称为自对准工艺(self-aligned),因为晶体管的源和漏自动形成在邻近栅的两侧而不需要精确地对准掩模。

- 然后进行p扩散、使圆片与金属层之间绝缘需要生长场氧、将金属铝溅射在整个圆片上并填充接触孔

[![image-20230423215652999](https://camo.githubusercontent.com/6780caef86ae97493a7bebe99b852e42b7e8ab332337cf8c26b3e7b1b722ac66/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233323135363038382e706e67)](https://camo.githubusercontent.com/6780caef86ae97493a7bebe99b852e42b7e8ab332337cf8c26b3e7b1b722ac66/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233323135363038382e706

chatgpt简述：CMOS（互补金属氧化物半导体）是一种重要的半导体器件技术，应用广泛于集成电路的制造中。CMOS制造工艺大致可以分为以下几个步骤：

1. 基片清洗和扩散：首先，通过酸洗和碱洗等步骤对硅基片进行表面清洗和去除杂质。然后在硅表面扩散掺杂物质（比如硼、磷等），用于形成PN结构。
2. 氧化：在硅表面覆盖一层氧化层（SiO2）作为电气绝缘层，可以通过化学气相沉积或者热氧化等方法制备。
3. 掩膜制作：根据电路设计要求，利用光刻技术将光阻覆盖在氧化层上，并使用掩膜对光阻进行曝光和显影。通过掩膜制作形成所需的结构和电路图形。
4. 金属化：在氧化层上利用物理气相沉积或化学气相沉积等技术，将金属（比如铝、铜等）沉积在表面，并用掩膜和蚀刻技术形成金属线路和接触。
5. 刻蚀和清洗：根据需要，对氧化层和金属层进行蚀刻和清洗，以形成所需的电路结构。
6. 贴片封装：将制作好的芯片贴装到封装底座上，并连接芯片的金属引脚与封装底座上的接口。

### 1.5.3 版图设计规则

​	版图设计规则说明了一个具体制造工艺能可靠密集制造的特征线条所允许的精细程度以及它们相互间允许的接近程度。工业界的设计规则常常以微米为单位来规定。

​	大学里常常采用可伸缩的设计规则来简化设计，这些设计规则比较保守，足以适用于许多种制  造工艺。Mead和Conway[Mead80]基于单个参数λ来表征工艺的分辨率，由此推广了可伸缩的设计  规则。λ一般是指所能设计的晶体管最小沟道长度的一半。沟道长度是晶体管源和漏之间的距离， 它由多晶硅线条的最小宽度确定。

​	λ规则比较简单和易 于按比例缩小，但它牺牲了基于微米的规则可能带来的格度优势。由于设计者经常用特征尺寸( fenture size)描述一种工艺，而特征尺寸是指晶体管的最小沟道长度，因此λ就是特征尺寸的一半。

​	180nm以下时，设计规则已变得非常复杂并且与具体的工艺有关，这使按比例伸 缩的设计规则很难应用。

[![image-20230423222903068](https://camo.githubusercontent.com/5a7960d813989c7f69b890aa96013ce9dda980783d181807dcb62e3c290ebad1/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233323232393136362e706e67)](https://camo.githubusercontent.com/5a7960d813989c7f69b890aa96013ce9dda980783d181807dcb62e3c290ebad1/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233323232393136362e706e67)

[![image-20230423222930651](https://camo.githubusercontent.com/a119ab2276ee5302f5a59fd51875871026107822c27f5c2266cffc29f3d864e1/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233323232393734372e706e67)](https://camo.githubusercontent.com/a119ab2276ee5302f5a59fd51875871026107822c27f5c2266cffc29f3d864e1/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233323232393734372e706e67)

​	在三层金属工艺中，第三层金属的宽度一般为6λ而间距为4λ。一般来说，在具有较多金属 层的工艺中，顶层金属线常常较厚、较宽因而具有较低的电阻。

​	晶体管的尺寸通常用它们的宽度/长度比(W/L)说明。带接触的最小宽度晶体管常常称为单位晶体管。

​	pMOS管往往 比nMOS管宽，因为空穴比电子移动得慢，因而pMOS管必须宽些才能传送相同的电流。

[![image-20230423224040510](https://camo.githubusercontent.com/3dba0945c10459594d9a0e5b37f9ac9d520dfcfdd60998f424534bd244c4af94/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233323234303538352e706e67)](https://camo.githubusercontent.com/3dba0945c10459594d9a0e5b37f9ac9d520dfcfdd60998f424534bd244c4af94/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233323234303538352e706e67)

​	(a)为一个单位反相器的版图，它包含一个单位nMOS管和一个两倍尺寸的pMOS管。(b)为这个反相器的电路图，图中标注了每个晶体管的宽度/长度比。(c)为本书中常用的晶体管尺寸简咯表示方法，它假设采用最小的沟道长度而只表示出宽度是单位宽度的多少倍。

​	在数字系统中，晶体管一般都设计成具有尽可能小的沟道长度，因为沟道较短的晶体管较快、尺寸较小并且功耗也较低。

### 

### 1.5.4 门级版图

​	



### 1.5.5 棒图



[![image-20230423233401266](https://camo.githubusercontent.com/54ef8d9d43fb4b68453c231edf7f211182fb54744be5345e7eeeb8fcf5182cf1/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233323333343334392e706e67)](https://camo.githubusercontent.com/54ef8d9d43fb4b68453c231edf7f211182fb54744be5345e7eeeb8fcf5182cf1/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233323333343334392e706e67)

​	版图的面积通常由金属导线决定

​	我们定义==布线通道(routing  track)==为能布置一条导线并能满足它与相邻导线间的间距要求的足够空间。例如，如果导线宽度为4λ,它与相邻导线间的间距要求也是4λ,那么布线通道的节距(pitch)即中心距就是8λ,如图1.44(a)所示。这一节距也已足够在两条导线之间布 置一个晶体管(见图1.44(b))。因此，==通过统计金属布线通道的数目并将它乘以8λ来预估一个单元的高度和宽度是很合理的

[![image-20230423233948086](https://camo.githubusercontent.com/ea97364b9fc4b076a2fbbe28e74a7b30ecfeb1c794391f0bbfb8571bff81377e/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233323333393231322e706e67)](https://camo.githubusercontent.com/ea97364b9fc4b076a2fbbe28e74a7b30ecfeb1c794391f0bbfb8571bff81377e/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233323333393231322e706e67)

​	由于有阱的原因，在nMOS和pMOS管之 间要求有12λ的间距，即在nMOS和pMOS管之间必须多分配一条额外的导线通道而不管实际上是否有导线使用它

​	图1.46中有四条垂直方向的导线通道（按我的理解是如图1.44的为导线通道，即头带黑框的），乘以每通道8λ的节距就可知单元宽度为32λ;而由五条水平方向的通道（这里没有按比例画）就可知单元高度为40λ。

[![image-20230423234014980](https://camo.githubusercontent.com/7f384f753383f3990fd89063b5bebd0da35d0c245bdfcbfbfcca626b06eefd9b/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233323334303038322e706e67)](https://camo.githubusercontent.com/7f384f753383f3990fd89063b5bebd0da35d0c245bdfcbfbfcca626b06eefd9b/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343233323334303038322e706e67)

## 

## 1.6 设计划分(Design Partitioning)

​    现代VLSI设计的挑战主要在于系统的复杂性，需要把存储器、处理器、高速I/O接口和专用逻辑集成到单块芯片上。这样的设计需要划分任务给许多大的工程师团队，同时需要在任务之间做出合适的折中选择，以确保设计效率和最终系统性能。在设计过程中，采用结构化的设计方法来驾驭系统的复杂性，利用层次化、规整化、模块化和局域化的原则。

层次化：指的是将系统划分为多个层次或模块，每个层次或模块都负责完成特定的功能，且不同层次或模块之间有明确的接口和交互方式。这样设计可以让系统更易于理解、修改和维护。

规整化：指的是将设计中的某些重复或常见的结构，抽象出来作为一种规则或标准。这样设计可以让系统更具有一致性、可维护性和可扩展性。

模块化：指的是将系统分成互相独立的模块，每个模块只关注自己的任务，与其他模块保持松散的耦合。这样设计可以使系统更易于测试、修改和重用。

局域化：指的是将模块内部的实现细节尽可能隐藏起来，只对外提供必要的接口和信息。这样设计可以降低模块之间的耦合度，使得模块更加独立和可重用。

这些原则在计算机系统的设计中广泛应用，可以帮助设计师们应对复杂的系统需求，提高设计效率和系统可靠性

### 1.6.1 设计抽象(Design Abstraction)

​    数字VLSI设计通常划分为五个抽象层次：体系结构、微结构、逻辑、电路和物理设计。这些设计要素相互依赖，会影响每一个设计目标。微结构、逻辑、电路和物理设计必须并行进行，或至少一部分应当如此。工程师们常常被分为“矮胖”型或“高瘦”型，高瘦型工程师了解较宽范围的各类专题概貌，而矮胖型工程师了解某个较窄领域的大量细节。数字VLSI设计需要高型工程师，因为他们能预先估计出对系统中某一部分的选择将怎样影响系统的其他部分。

- 体系结构描述系统的功能
- 微结构描述体系结构如何划分成寄存器和功能部件
- 逻辑设计描述如何构成功能部件
- 电路设计描述如何用晶体管实现逻辑
- 物理设计描述芯片的版图

​	这些设计要素有内在的相关性，它们都会影响每一个设计目标。为了解决这些相互依赖的问题，微结构、逻辑、电路和物理设计必须并行进行，或至少一部分应当如此。

### 

### 1.6.2 结构化设计

​	层次化(hierarchy)是处理复杂设计的关键手段。一个大系统可以分层次地划分成几个核  (core),每个核由各种部件(unit)构成，每个部件又由多个功能块(functional  block)构成。这些功能块再由单元(cell)组成，单元最终由晶体管实现。可以把设计层次看成是一种树结构，即整块芯片是根(root)而基本单元是叶(leaf)。

​	规整化(regularity)通过尽可能设计种类数目最少的不同功能块来降低设计的复杂性。

​	模块化(madularity)要求每个功能块都有确切定义的接口以避免未预想到的相互影响。

​	局域化(locality)是指将信息保持在使用它的物理位置和时间段上。





### 1.6.3 行为、结构和物理设计域

[![image-20230425162403644](https://camo.githubusercontent.com/46b5501daa2b0b12108e8c69a2625017818aae3ae1012e8979cf0332e68cca1f/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235313632343830362e706e67)](https://camo.githubusercontent.com/46b5501daa2b0b12108e8c69a2625017818aae3ae1012e8979cf0332e68cca1f/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235313632343830362e706e67)





## 1.7 举例：一个简单的MIPS微处理器

MIPS微处理器体系结构[Patterson04，Harris07]的一个8位子集，因为它被广泛研究且相对简单，但其规模已足以用来说明层次化设计。

www.cmosvlsicom的网站上提供了一组实验练习读者可以通过使用免费的开源CAD工具(称为Electric)或 Cadence和 Synopsys 的商用设计工具，自己来构造这个微处理器以学习 VISI设计

### 1.7.1 MIP体系结构

​	这个体系 结构子集采用32位指令编码但只有八个8位的通用寄存器($0~$7)。另外还有一个8位的程序  计数器(Program Counter,PC)。寄存器0通过硬布线使它的各位都含数字0。指令有ADD(加)、  SUB(减)、AND(按位与)、OR(按位或)、SLT(小于时置1)、ADDI(立即数加)、BEQ(相等时转移)、  J(跳转)、LB(取字节)和SB(存字节)。

[![image-20230425165605453](https://camo.githubusercontent.com/d43af0c755702ae7c8ae6b4548561c93e2f2a27720c7cb25486101d2a92452c1/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235313635363534372e706e67)](https://camo.githubusercontent.com/d43af0c755702ae7c8ae6b4548561c93e2f2a27720c7cb25486101d2a92452c1/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235313635363534372e706e67)

[![image-20230425165642261](https://camo.githubusercontent.com/8d7dfbe3d2c5ed9fd2f46c6fd0b5eb8f2eaeb8a6cdbb026c06e1d37d51d7f265/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235313635363331332e706e67)](https://camo.githubusercontent.com/8d7dfbe3d2c5ed9fd2f46c6fd0b5eb8f2eaeb8a6cdbb026c06e1d37d51d7f265/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235313635363331332e706e67)

​	我们可以用汇编语言(assembly  language)为MIPS处理器编程，不过一般用高级语言(high-level  language)如C或Java编程。编译器(compiler)将一个程序从高级语言的源代 码(source  code)转换成合适的机器语言的目标码(object code)。

[![image-20230425170250463](https://camo.githubusercontent.com/982e430c9f2a9241888dba2102e52cad316366d7a1e7abaa208105799049204d/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235313730323533362e706e67)](https://camo.githubusercontent.com/982e430c9f2a9241888dba2102e52cad316366d7a1e7abaa208105799049204d/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235313730323533362e706e67)

[![image-20230425170259462](https://camo.githubusercontent.com/c2a19663d7d48b4d75b058627aa00967819db6b25bbe4be3420616bd89f73207/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235313730323532342e706e67)](https://camo.githubusercontent.com/c2a19663d7d48b4d75b058627aa00967819db6b25bbe4be3420616bd89f73207/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235313730323532342e706e67)

[![image-20230425170310242](https://camo.githubusercontent.com/11810b389107d950ab3eda09866f901d497a8ba4ed63c1cd3ca763d6833ba220/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235313730373833332e706e67)](https://camo.githubusercontent.com/11810b389107d950ab3eda09866f901d497a8ba4ed63c1cd3ca763d6833ba220/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235313730373833332e706e67)

[![image-20230425170322899](https://camo.githubusercontent.com/20c0e4b71f36ced538b96500e54781f46c5bde47e65cc8706f3c67e4b2e9c677/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235313730333935362e706e67)](https://camo.githubusercontent.com/20c0e4b71f36ced538b96500e54781f46c5bde47e65cc8706f3c67e4b2e9c677/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235313730333935362e706e67)



### 1.7.2 多周期MIPS微结构



## 1.8 逻辑设计

​	 我们从定义顶层的芯片接口和方块图开始逻辑设计，然后逐层分解部件直至得到叶子单元。我们利用硬件描述语言(Hardware Description  Language,HDL)来描述逻辑。这一描述代码常称为寄存器传输级(Register Transfer Level,RTL) 描述。



### 1.8.1 顶层接口

[![image-20230425170548085](https://camo.githubusercontent.com/d04db36381998223b87399e24a46754ef203c7fa965b86a824ae81ef5c2d12f3/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235313730353134332e706e67)](https://camo.githubusercontent.com/d04db36381998223b87399e24a46754ef203c7fa965b86a824ae81ef5c2d12f3/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235313730353134332e706e67)

​	这里采用两相位时钟系统以避免保持时间(hold-time)问题。复位(Reset)信号使PC初始化为0因而控制FSM回到起始状态。

[![image-20230425170621703](https://camo.githubusercontent.com/dfc5ea7c297c836125c765ded75bd3b92207d2d0f9e2747a3e9227977e6a789d/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235313730363736332e706e67)](https://camo.githubusercontent.com/dfc5ea7c297c836125c765ded75bd3b92207d2d0f9e2747a3e9227977e6a789d/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235313730363736332e706e67)

​	处理器送出8位的地址Adr并根据要求决定是否将Merwrite置为有效。在读周期时，存储器将送出一个值并放到MemData线上，而在写周期时，存储器将接受来自WriteData线上的输入。

​	在许多系统中，MemData和WriteData可以合成为一条双向总线。



### 1.8.2 方块图

![image-20230427203247148](C:\Users\kope\AppData\Roaming\Typora\typora-user-images\image-20230427203247148.png)

控制器包括控制 FSM、ALU译码器和两个用来产生PCEn信号的逻辑门。

ALU译码器由组合逻辑构成用来产生 ALUContmol信号。

芯片的其余部分为8位的数据通路。可以把它看成是字片(wordslice)或位片(bitslice)的集合。字片含一列8位的触发器、加法器、多路开关或其他元件

[![image-20230425172724510](https://camo.githubusercontent.com/c2f26328be8f693dd89bbd56def34c75f3df977735ce5da2247717ff66f19bc8/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235313732373538352e706e67)](https://camo.githubusercontent.com/c2f26328be8f693dd89bbd56def34c75f3df977735ce5da2247717ff66f19bc8/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235313732373538352e706e67)

​	它含有8个独立的一位2:1多路开关，以及一个由缓冲器和反相器 构成的拉链电路(zipper)用来驱动所有这8个多路开关的正反选择信号。这种不在各个多路开关中设置反相器而是把这些驱动器提取出来集中用一个拉链电路驱动的方式可以节省许多空间。我们可以把数据通路看成是8行位片。每个位片含各个组件中的-·位以及将这些位连 在一起的水平导线。

​	 芯片划分受物理设计规划的影响。数据通路含大部分的晶体管并凡结构非常规整。通过==手工设计每一字片或位片然后把这些电路像瓦片那样铺在一起==可以使我们花费不多的功夫就能达到很高的密度。==通常利用字片构成数据通路==比较容易，因为某些结构如ALU中判“O”(判断是否为零)的电路在各个位片中并不相同。但是考虑位片形式对于规划穿越数据通路的布线很有帮助。控制器的结构性要差得多。用手工将FSM转换成逻辑门非常麻烦，而且在一个新的设计中，控制器是最有可能出现故障的部分并且常常到设计的最后阶段还要修改。因此，我们将==用硬件描述语言较为抽象地描述控制器，并用综合(synthesis) 和布局布线(place&route)工具或可编程逻辑阵列(Programmable Logic Array,PLA)自动生成它==。



### 1.8.3 设计层次

[![image-20230425215418450](https://camo.githubusercontent.com/97356b6079c22387126f67f5cc62056d14fda3c783406735c11caad54684e64e/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235323135343533302e706e67)](https://camo.githubusercontent.com/97356b6079c22387126f67f5cc62056d14fda3c783406735c11caad54684e64e/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235323135343533302e706e67)

​	 控制器含 controller_pla(控制器 PLA)和aludec(ALU译码器)两部分，它们又由标准库单元如与非门、或非门和反相器等构成。在逻辑、电路和物理设计中的设计层次不一定需要完全相同。例如，从邃辑角度看，最好将存储器看成是一个黑匣子，而在电路实现时，它可以划分成译码器、存储单元阵列、列多路开关等。但设计层次各不相同将使验证复杂化，因为它们必须被展平(flartened)直到它们都一致为止。因此实际设计时，最好使逻辑、电路和物理的设计层次尽可能一致。

### 

### 1.8.4 硬件描述语言

​	在将方块图和FSM的状态转移图转换成电路原理图之前最好先确认一下顶层设计是否存在需要我们完全重新设计的严重错误。硬件描述语言(HDL)提供了一种在较高抽象层次上描述设计的方法，它能提高设计者的设计效率。

​	当前两种最流行的HDL是Verilog和VHDL。Verilog比较简明并接近C语言的句法，而VHDL支持对大团队项目很有用的某些抽象功能。无论哪一种语言都没有对另一种语言的绝对优势，所以工业界不得不同时支持这两种语言

​	当用HDL编码时，应当注意你是在描述==并行操作的硬件==而不是顺序执行的软件。有两种一般的编码方式：结构级(structural)HDL描述一个单元如何由其他单元或基本逻辑门及晶体管组成，而行为级(behaviaral)HDL描述这个单元做什么。

​	逻辑模拟器(logic  simulator)用来模拟HDL代码，它能报告模拟结果是否与期望结果相符，并能显示波形以帮助查找出现差别的原因。逻辑综合(logic  synthesis)工具类似于一个硬件编译器：它将HDL代码映射到一组称为标准单元(standard  cell)的逻辑门库(library)上，使面积尽可能小且能满足某些时序约束(timing  constraint)。但只有部分HDL结构是可综合的，本书附录将重点列出这一子集。

​	 由逻辑综合生成的电路一般总不如由经验丰富的设计者手工完成的电路面积小和速度快。但集成电路工艺现在已很先进，因此综合生成的电路对于今天所需的绝大多数专用集成电路(Application-Specitic Integrated Circuit,ASIC)来讲已足够好，它们的版图可以用布局布线工具自动生成。

​	 附录A.12列出了MIPS处理器的Verilog和VHDL模型。在Verilog中，每个单元称为模块(module)。它的输入/输出说明与C程序中的说明非常类似，其中总线是用位宽(bit  width)来表示的。内部信号也必须用与局部变量相类似的方式表示。这一处理器在==顶层上用结构级Verilog分层次地描述==，而对==叶子单元采用行为级Verilog描述==。

​	例如，控制器模块显示了如何用行为级Verilog描述有限状态机而aludec模块显示了如何描述复杂的组合逻辑。数据通路用字片(wordslice)进行结构级描述，而字片再进行行为级描述。

[![image-20230425224743209](https://camo.githubusercontent.com/bca39430d5f35b7e6d3b209cfbd1ceccc14e8df088c59d9b9e246ce493dae6c4/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235323234373238372e706e67)](https://camo.githubusercontent.com/bca39430d5f35b7e6d3b209cfbd1ceccc14e8df088c59d9b9e246ce493dae6c4/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235323234373238372e706e67)

​	我们可以把一个8位的加法器字片在结构上描述成由8个全加器串联起来组成的一个串行进位加法器。全加器可以在结构上表示成一个求和(sum)子电路和一个进位(cary)子电路。求和及进位子电路又可以用行为级来描述

[![image-20230425224907052](https://camo.githubusercontent.com/b564051e090c4cbf0e625bc8f89a949b25bb44f63285a84e20fa9ad339101015/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235323234393132392e706e67)](https://camo.githubusercontent.com/b564051e090c4cbf0e625bc8f89a949b25bb44f63285a84e20fa9ad339101015/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235323234393132392e706e67)

## 

## 1.9 电路设计

​	 电路设计涉及安排晶体管去执行一个具体的逻辑功能。有了电路设计就可以估计出它的延时和功耗。电路可以表示成电路原理图，或用文本方式表示成网表(netlist)。常用的晶体管级网表格式包括Verilog和SPICE。Verilog网表用于功能验证，而SPICE网表含进行延时和功耗模拟所必需的更多细节。

​	由于晶体管栅是良绝缘体，所以可以把它建模成一个电容C。当晶体管导通时，在它的源和漏之间就会有某个电流I流动。这一电流和电容的大小都与晶体管的宽度成正比。

[![image-20230425225458021](https://camo.githubusercontent.com/f1558684beab47deb68cf3c302f1a265b36d25b892fa8bb012a7e82d3d09fda3/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235323235343037392e706e67)](https://camo.githubusercontent.com/f1558684beab47deb68cf3c302f1a265b36d25b892fa8bb012a7e82d3d09fda3/68747470733a2f2f67697465652e636f6d2f65706874696e792f696d6167652f7261772f6d61737465722f696d672f3230323330343235323235343037392e706e67)

​	

## 1.10 物理设计

物理设计首先从平面规划(florplan)开始。平面规划将估计芯片中主要部件的面积并定义它们间的相对位置。它的重要性在于它将决定所提出的设计方案是否能满足芯片面积的预算要求并能估计出布线长度和布线的拥挤程度。在大致确定逻辑之后就应当尽快做出最初的平面规划。通常这是一个反复的过程。平面规划中常常会提出修改逻辑(和微结构)，但这些修改又反过来会要求调整平面规划。

此外，当一个复杂设计开始固定下来时，常常需要把平面规划按层次细分以描述各个部件内部的功能块。平面规划的难点在于需要在着手进行芯片的细节设计(它取决于平面规划和布线长度)之前预先估计出每个部件的尺寸。![7c92ac3a8d9ea6b6d5e3521b3f2554b](C:\Users\kope\AppData\Local\Temp\WeChat Files\7c92ac3a8d9ea6b6d5e3521b3f2554b.png)

图1.62 显示了 MIPS 处理器片包括焊盘在内的面规划图。顶层功能块是控制器和数据通路。布线通道位于这两个功能块之间以提供空间把控制信号布线到数据通路。数据通路进步划分成字片。这一平面规划图按比例绘制并标注了尺寸。芯片用0.6 m 工设计成1.5 mx1.5 mm的管芯，因此该管芯的每边长50002。每个焊盘为 750x350因此在焊盘框内最大可能的内核面积为3500x3500=12.25M2。实际的内核面积为4.8M入它大于各功能块面积的和因为它还包括了布线通道。

### 1.10.1 平面规划



### 1.10.2 标准单元



### 1.10.3 节距匹配



### 1.10.4 分片规划



### 1.10.5 阵列



### 1.10.6 面积估算



## 1.11 设计验证

a

## 1.12 制造、封装和测试